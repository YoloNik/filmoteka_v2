{"version":3,"sources":["js/fetchApi.js","js/markup-movie-card.js","js/markup-library.js","js/markup-modal.js","js/local-storage.js","library.js"],"names":["apiService","fetchAPI","constructor","searchQuery","page","totalPages","genres","movieId","getTrendMovies","URLQuery","BASE_URL","API_KEY","encodeURIComponent","fetch","then","response","status","Error","json","data","catch","error","console","log","query","newQuery","getGenres","ok","Promise","reject","normaGenres","reduce","acc","id","name","genresValue","getSingleMovie","movieGallery","document","querySelector","errorText","fetchMoviesWhisGenres","style","visibility","movieData","results","map","movieEl","genre_ids","generEl","join","createCards","movieCard","el","idx","createElement","innerHTML","poster_path","title","release_date","substr","total_results","library","watchedBtn","queueBtn","optionsBtn","storageWatched","JSON","parse","localStorage","getItem","storageQueue","renderLibraryMarkup","closest","renderMovie","toggleLibrary","e","target","classList","add","remove","storage","markup","addEventListener","modalWin","fetcMovieForModal","createModal","original_title","vote_average","vote_count","popularity","overview","localStorageMovie","watched","queue","window","addMovie","isExist","find","push","setItem","stringify","modal","openModal","onEscCloseModal","dataset","display","closeModal","className","code","removeEventListener"],"mappings":"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","file":"library.1c1feb50.js","sourceRoot":"../src","sourcesContent":["class fetchAPI {\n  BASE_URL = 'https://api.themoviedb.org/3';\n  API_KEY = `87f9885ae1efa5e26738121aab64796c`;\n  constructor() {\n    this.searchQuery = '';\n    this.page = 1;\n    this.totalPages;\n    this.genres = {};\n    this.movieId = '';\n  }\n\n  async getTrendMovies() {\n    let URLQuery = this.searchQuery\n      ? `${this.BASE_URL}/search/movie?api_key=${\n          this.API_KEY\n        }&language=en-US&page=${\n          this.page\n        }&include_adult=false&query=${encodeURIComponent(this.searchQuery)}`\n      : `${this.BASE_URL}/trending/movie/week?api_key=${this.API_KEY}&page=${this.page}`;\n\n    return await fetch(URLQuery)\n      .then(response => {\n        if (response.status === 404) throw new Error();\n\n        return response.json();\n      })\n      .then(data => {\n        return data;\n      })\n      .catch(error => console.log(error));\n  }\n\n  get query() {\n    return this.searchQuery;\n  }\n\n  set query(newQuery) {\n    this.searchQuery = newQuery;\n  }\n\n  async getGenres() {\n    return await fetch(\n      `${this.BASE_URL}/genre/movie/list?api_key=${this.API_KEY}`\n    )\n      .then(data => {\n        if (data.ok) {\n          return data.json();\n        }\n        return Promise.reject(new Error('Error'));\n      })\n      .then(data => {\n        const normaGenres = data.genres.reduce((acc, { id, name }) => {\n          return { ...acc, [id]: name };\n        }, {});\n        this.genres = normaGenres;\n        return normaGenres;\n      })\n      .catch(error => console.log(error));\n  }\n  get genresValue() {\n    return this.genres;\n  }\n  async getSingleMovie() {\n    return await fetch(\n      `${this.BASE_URL}/movie/${this.movieId}?api_key=${this.API_KEY}`\n    )\n      .then(response => {\n        if (response.status === 404) throw new Error();\n\n        return response.json();\n      })\n      .then(data => {\n        return data;\n      })\n      .catch(error => console.log(error));\n  }\n}\n\nconst apiService = new fetchAPI();\nexport default apiService;\n","import apiService from './fetchApi';\n\nconst movieGallery = document.querySelector(`.gallery`);\nconst errorText = document.querySelector(`.search__error`);\n\nexport default function fetchMoviesWhisGenres() {\n  errorText.style.visibility = `hidden`;\n  apiService.getGenres();\n  apiService.getTrendMovies().then(movieData => {\n    const genres = apiService.genresValue;\n    const normaGenres = movieData.results.map(movieEl => {\n      return movieEl.genre_ids\n        .map(generEl => {\n          if (genres[generEl]) return genres[generEl];\n        })\n        .join(', ');\n    });\n    createCards(movieData.results, normaGenres);\n  });\n}\n\nexport function createCards(movieData, normaGenres) {\n  const movieCard = movieData\n    .map((el, idx) => {\n      let movieCard = document.createElement(`div`);\n      return (movieCard.innerHTML = `<div class=\"movie-card\">\n<img src=\"${\n        el.poster_path\n          ? 'https://image.tmdb.org/t/p/w500' + el.poster_path\n          : 'https://expresspost.in///website/images/reporter_image/default.png'\n      }\" data-id=\"${el.id}\" alt=\"There should be a poster ðŸ˜®\">\n  <div class=\"movie-card__title\">\n\t\t<span>${el.title}</span>\n\t<div class=\"movie-card__info-item\">\n\t\t<span>${normaGenres[idx]} | ${el.release_date.substr(0, 4)}</span>\n\t</div>\n  </div>\n</div>`);\n    })\n    .join('');\n  if (movieData.total_results === 0) {\n    movieGallery.innerHTML = '';\n    errorText.style.visibility = `visible`;\n  } else {\n    movieGallery.innerHTML = movieCard;\n  }\n}\n","import { createCards } from './markup-movie-card';\n\nconst library = document.querySelector('.library');\nconst watchedBtn = document.querySelector('.watchet-btn');\nconst queueBtn = document.querySelector('.queue-btn');\nconst optionsBtn = document.querySelector('.nav-op');\n\nlet storageWatched = JSON.parse(localStorage.getItem(`watched`)) || [];\nlet storageQueue = JSON.parse(localStorage.getItem('queue')) || [];\n\noptionsBtn.addEventListener('click', toggleLibrary);\n\nexport default function renderLibraryMarkup() {\n  if (watchedBtn.closest('.active-btn')) {\n    renderMovie(storageWatched);\n  } else {\n    renderMovie(storageQueue);\n  }\n}\n\nfunction toggleLibrary(e) {\n  if (e.target === watchedBtn) {\n    watchedBtn.classList.add('active-btn');\n    queueBtn.classList.remove('active-btn');\n    storageWatched = JSON.parse(localStorage.getItem(`watched`));\n    renderMovie(storageWatched);\n  }\n  if (e.target === queueBtn) {\n    queueBtn.classList.add('active-btn');\n    watchedBtn.classList.remove('active-btn');\n    storageQueue = JSON.parse(localStorage.getItem('queue'));\n    renderMovie(storageQueue);\n  }\n}\n\nfunction renderMovie(storage) {\n  library.innerHTML = '';\n  let markup = storage\n    .map(el => {\n      const normaGenres = el.genres.map(genres => genres[`name`]).join(', ');\n      return `<div class=\"movie-card\">\n      <img class=\"movie\" src=\"https://image.tmdb.org/t/p/w500${\n        el.poster_path\n      }\" data-id=\"${el.id}\">\n      <p class=\"movie-card__title\">\n        ${el.title}\n        <div class=\"movie-card__info-item\">\n          <span class=\"genre\">${normaGenres} | ${el.release_date.substr(\n        0,\n        4\n      )}</span>\n        </div>\n      </p></div>`;\n    })\n    .join('');\n  library.innerHTML = markup;\n}\n","import apiService from './fetchApi';\n//import fetchNormaMovie from './markup-movie-card';\n\nconst modalWin = document.querySelector('.output-js');\n\nexport default async function fetcMovieForModal() {\n  return await apiService.getSingleMovie().then(movieData => {\n    const normaGenres = movieData.genres\n      .map(genres => genres[`name`])\n      .join(', ');\n    createModal(movieData, normaGenres);\n  });\n}\n\nfunction createModal(movieData, normaGenres) {\n  return (modalWin.innerHTML = `<img class=\"modal-content__img\"\n\t\t\tsrc=\"${\n        movieData.poster_path\n          ? 'https://image.tmdb.org/t/p/w500' + movieData.poster_path\n          : 'https://expresspost.in///website/images/reporter_image/default.png'\n      }\" alt=\"${movieData.original_title}\" />\n    <div class=\"wrap\">\n      <h2 class=\"modal-content__title\">${movieData.original_title}</h2>\n      <div class=\"info-wrap modal-content__info-wrap\">\n        <ul class=\"category-list\">\n          <li class=\"category-list__item\">Vote / Votes</li>\n          <li class=\"category-list__item\">Popularity</li>\n          <li class=\"category-list__item\">Original Title</li>\n          <li class=\"category-list__item\">Genre</li>\n        </ul>\n        <ul class=\"category-value-list modal-content__category-value-list\">\n          <li class=\"category-value-list__item\">\n\t\t\t\t\t\t<p class=\"category-value-list__item_bg-color\">${movieData.vote_average} </p>\n\t\t\t\t\t\t<p class=\"category-value-list__item_font-color\"> / ${\n              movieData.vote_count\n            } </p> </li>\n          <li class=\"category-value-list__item\">${movieData.popularity}</li>\n          <li class=\"category-value-list__item\">${movieData.title}</li>\n          <li class=\"category-value-list__item\">${normaGenres}</li>\n        </ul>\n      </div>\n\t\t\t   <h3 class=\"modal-content__subtitle\">About</h3>\n      <p class=\"modal-content__description\">${movieData.overview}</p>\n      <div class=\"btn-wrap content__btn-wrap\">\n          <button class=\"btn-wrap__btn active\" data-action=\"watched\">add to Watched</button>\n          <button class=\"btn-wrap__btn \" data-action=\"queue\">add to Queue</button>\n        </div>\n    `);\n}\n","import apiService from './fetchApi';\n\nexport default function localStorageMovie() {\n  let watched = [];\n  let queue = [];\n  if (localStorage.getItem('watched')) {\n    watched = JSON.parse(localStorage.getItem('watched'));\n  }\n  if (localStorage.getItem('queue')) {\n    queue = JSON.parse(localStorage.getItem('queue'));\n  }\n\n  window.addEventListener(`click`, addMovie);\n\n  function addMovie(e) {\n    apiService.getSingleMovie().then(movieData => {\n      if (e.target.closest(`[data-action=\"watched\"]`)) {\n        const isExist = watched.find(el => {\n          return el.id === movieData.id;\n        });\n        if (!isExist) {\n          watched.push(movieData);\n          localStorage.setItem('watched', JSON.stringify(watched));\n        }\n      }\n      if (e.target.closest(`[data-action=\"queue\"]`)) {\n        const isExist = queue.find(el => {\n          return el.id === movieData.id;\n        });\n        if (!isExist) {\n          queue.push(movieData);\n          localStorage.setItem('queue', JSON.stringify(queue));\n        }\n      }\n    });\n  }\n}\n","import renderLibraryMarkup from './js/markup-library';\nimport { toggleLibrary } from './js/markup-library';\nimport fetcMovieForModal from './js/markup-modal';\nimport localStorageMovie from './js/local-storage';\nimport apiService from './js/fetchApi';\n\nconst library = document.querySelector('.library');\nconst modal = document.querySelector('.backdrop-modal');\n\nlibrary.addEventListener('click', openModal);\nmodal.addEventListener('click', closeModal);\n\nrenderLibraryMarkup();\n//toggleLibrary();\n\nfunction openModal(e) {\n  window.addEventListener(`keydown`, onEscCloseModal);\n  if (e.target.closest('.movie-card')) {\n    let movieId = e.target.dataset.id;\n    apiService.movieId = movieId;\n    fetcMovieForModal();\n\n    modal.style.display = `block`;\n    localStorageMovie();\n  }\n}\nfunction closeModal(e) {\n  if (\n    e.target.closest(`.modal-content__close-btn`) ||\n    e.target.className === 'backdrop-modal'\n  ) {\n    modal.style.display = `none`;\n  }\n}\nfunction onEscCloseModal(e) {\n  if (e.code === 'Escape') {\n    modal.style.display = `none`;\n    window.removeEventListener(`keydown`, onEscCloseModal);\n  }\n}\n"]}